<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Warehouse Section Locator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      background: #f9f9f9;
    }
    input[type="text"] {
      padding: 10px;
      font-size: 16px;
      width: 300px;
    }
    #result {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
    }
    .map-wrapper {
      display: flex;
      justify-content: center;
      padding: 20px;
      margin-top: 20px;
    }
    svg {
      background: white;
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .section {
      fill: white;
      stroke: red;
      stroke-width: 0.5;
    }
    .highlight {
      fill: yellow !important;
      stroke: black;
      stroke-width: 1.5;
    }
    .walkway {
      fill: #a3e6a3;
      opacity: 1;
    }
    .aisle-label {
      font-size: 10px;
      font-weight: bold;
      fill: black;
    }
  </style>
</head>
<body>
  <h1>üè≠ Warehouse Section Locator</h1>
  <p>Enter Item Code:</p>
  <input id="searchBox" type="text" placeholder="e.g. LCQ" />
  <div id="result"></div>

  <div class="map-wrapper">
    <svg viewBox="0 0 950 750">
      <!-- Walkway -->
      //<rect x="0" y="350" width="950" height="40" class="walkway" />
      <g id="aisles"></g>
    </svg>
  </div>

  <script>
    const aisleConfig = {
      A: { front: 3, back: 9 },
      B: { front: 3, back: 9 },
      C: { front: 3, back: 9 },
      D: { front: 4, back: 12 },
      E: { front: 4, back: 12 },
      F: { front: 4, back: 12 },
      G: { front: 4, back: 12 },
      H: { front: 4, back: 12 },
      I: { front: 4, back: 12 },
      J: { front: 1, back: 0 }
    };

    const aisleSpacing = 70;
    const sectionSize = 12;
    const padding = 1.5;
    const offsetX = 40;
    const svg = document.getElementById("aisles");

    function drawSections() {
      let index = 0;
      for (let aisle in aisleConfig) {
        const { front, back } = aisleConfig[aisle];
        const x = offsetX + index * aisleSpacing;

        // Label
        const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
        label.setAttribute("x", x + sectionSize);
        label.setAttribute("y", 20);
        label.setAttribute("class", "aisle-label");
        label.textContent = aisle;
        svg.appendChild(label);

        // FRONT (Before Walkway)
        for (let i = 0; i < front; i++) {
          ["Left", "Right"].forEach((side, sIndex) => {
            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", x + sIndex * (sectionSize + padding));
            rect.setAttribute("y", 20 + i * (sectionSize + padding));
            rect.setAttribute("width", sectionSize);
            rect.setAttribute("height", sectionSize);
            rect.setAttribute("class", "section");
            rect.setAttribute("id", `${aisle}-Top-BW-${side}-${i + 1}`);
            svg.appendChild(rect);
          });
        }

        // BACK (After Walkway)
        for (let i = 0; i < back; i++) {
          ["Left", "Right"].forEach((side, sIndex) => {
            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", x + sIndex * (sectionSize + padding));
            rect.setAttribute("y", 150 + i * (sectionSize + padding));
            rect.setAttribute("width", sectionSize);
            rect.setAttribute("height", sectionSize);
            rect.setAttribute("class", "section");
            rect.setAttribute("id", `${aisle}-Top-AW-${side}-${i + 1}`);
            svg.appendChild(rect);
          });
        }

// if (aisle === 'J') {
//   const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
//   rect.setAttribute("x", 100);
//   rect.setAttribute("y", 680);
//   rect.setAttribute("width", 750);
//   rect.setAttribute("height", 30);
//   rect.setAttribute("class", "section");
//   rect.setAttribute("id", "J-Full");
//   svg.appendChild(rect);
// }


        index++;
      }
    }

    function clearHighlights() {
      document.querySelectorAll(".section").forEach(el => el.classList.remove("highlight"));
    }

    async function searchItem() {
      const query = document.getElementById("searchBox").value.trim().toUpperCase();
      const response = await fetch("warehouse_inventory_map.csv");
      const text = await response.text();
      const rows = text.split("\n").slice(1);
      const data = rows.map(row => {
        const [code, aisle, level, block, side, section] = row.split(",");
        return { code, aisle, level, block, side, section };
      });

      const resultBox = document.getElementById("result");
      clearHighlights();
      const match = data.find(r => r.code === query);

      if (match) {
        const { aisle, level, block, side, section } = match;
        const id = (aisle === 'J' || !block || !side || !section)
          ? (aisle === 'J' ? 'J-Full' : aisle)
          : `${aisle}-${level}-${block.replace(/ /g, '')}-${side}-${section}`;

        const el = document.getElementById(id);
        if (el) el.classList.add("highlight");

        resultBox.textContent = `‚úÖ Found: Aisle ${aisle} ${section ? `| Section ${section} ${side}, ${block}` : ''}`;
      } else {
        resultBox.textContent = "‚ö†Ô∏è Item not found";
      }
    }

    document.getElementById("searchBox").addEventListener("input", searchItem);
    drawSections();
  </script>
</body>
</html>
